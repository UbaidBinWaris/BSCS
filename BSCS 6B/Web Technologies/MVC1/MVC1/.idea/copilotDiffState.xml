<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/src/main/java/pk/edu/zab/controller/UserController.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/pk/edu/zab/controller/UserController.java" />
              <option name="originalContent" value="package pk.edu.zab.controller;&#10;&#10;import java.io.IOException;&#10;import java.util.List;&#10;&#10;import javax.servlet.RequestDispatcher;&#10;import javax.servlet.ServletException;&#10;import javax.servlet.http.HttpServlet;&#10;import javax.servlet.http.HttpServletRequest;&#10;import javax.servlet.http.HttpServletResponse;&#10;import javax.servlet.http.HttpSession;&#10;&#10;import pk.edu.zab.dao.UserDAO;&#10;import pk.edu.zab.model.UserModel;&#10;&#10;@SuppressWarnings(&quot;serial&quot;)&#10;public class UserController extends HttpServlet {&#10;&#9;private RequestDispatcher dispatch;&#10;&#9;private String view, kase;&#10;&#9;private String username;&#10;&#9;private String password;&#10;&#9;UserModel um = new UserModel();&#10;&#9;private int userId;&#10;&#9;private String UserName;&#10;&#9;private String getRoles;&#10;&#9;HttpSession session = null;&#10;&#9;private int role_id;&#10;&#10;&#10;    protected void service(HttpServletRequest request, HttpServletResponse response)&#10;&#9;&#9;&#9;throws ServletException, IOException {&#10;&#10;&#10;&#9;&#9;kase = (String) request.getAttribute(&quot;kase&quot;);&#10;&#10;&#9;&#9;if (&quot;auth&quot;.equals(kase)) {&#10;&#10;&#9;&#9;&#9;HttpSession session = request.getSession(false);&#10;&#9;&#9;&#9;if (session != null &amp;&amp; session.getAttribute(&quot;UserName&quot;) != null) {&#10;&#9;&#9;&#9;&#9;request.getRequestDispatcher(&quot;/user/welcome&quot;).forward(request, response);&#10;&#9;&#9;&#9;} else {&#10;&#9;&#9;&#9;&#9;username = request.getParameter(&quot;username&quot;);&#10;&#9;&#9;&#9;&#9;password = request.getParameter(&quot;password&quot;);&#10;&#9;&#9;&#9;&#9;System.out.println(&quot;ID pass: &quot; + username);&#10;&#9;&#9;&#9;&#9;// need to check user &amp; pass&#10;&#9;&#9;&#9;&#9;UserDAO ud = new UserDAO();&#10;&#9;&#9;&#9;&#9;UserModel um = ud.checkUser(username, password);&#10;&#10;&#9;&#9;&#9;&#9;if (um.getUser() != null) {&#10;&#9;&#9;&#9;&#9;&#9;System.out.println(&quot;Valid user&quot;);&#10;&#9;&#9;&#9;&#9;&#9;userId = (int) um.getIduser();&#10;&#9;&#9;&#9;&#9;&#9;UserName = (String) um.getUser();&#10;&#9;&#9;&#9;&#9;&#9;System.out.println(&quot;userId: &quot; + userId);&#10;&#10;&#9;&#9;&#9;&#9;&#9;session = request.getSession();&#10;&#9;&#9;&#9;&#9;&#9;session.setAttribute(&quot;UserName&quot;, UserName);&#10;&#10;&#9;&#9;&#9;&#9;&#9;request.setAttribute(&quot;session&quot;, session);&#10;&#9;&#9;&#9;&#9;&#9;request.getRequestDispatcher(&quot;WEB-INF/jsps/user.welcome.jsp&quot;).forward(request, response);&#10;&#9;&#9;&#9;&#9;} else {&#10;&#9;&#9;&#9;&#9;&#9;System.out.println(&quot;Not valid user&quot;);&#10;&#9;&#9;&#9;&#9;}&#10;&#9;&#9;&#9;}&#10;&#9;&#9;}&#10;&#9;&#9;// edit this portion&#10;&#9;&#9;else if (&quot;login&quot;.equals(kase)) {&#10;&#9;&#9;&#9;System.out.println(&quot;Inside Login Case&quot;);&#10;&#9;&#9;&#9;HttpSession session = request.getSession(false);&#10;&#9;&#9;&#9;if (session != null &amp;&amp; session.getAttribute(&quot;UserName&quot;) != null) {&#10;&#9;&#9;&#9;&#9;request.getRequestDispatcher(&quot;/WEB-INF/jsps/user.welcome.jsp&quot;).forward(request, response);&#10;&#9;&#9;&#9;}&#10;&#10;&#9;&#9;&#9;else {&#10;&#9;&#9;&#9;&#9;request.getRequestDispatcher(&quot;/WEB-INF/jsps/user.login.jsp&quot;).forward(request, response);&#10;&#9;&#9;&#9;}&#10;&#10;&#9;&#9;}&#10;&#9;&#9;else if (&quot;signup&quot;.equals(kase)) {&#10;&#9;&#9;&#9;System.out.println(&quot;Inside Signup Case&quot;);&#10;&#9;&#9;&#9;request.getRequestDispatcher(&quot;/WEB-INF/jsps/user.signup.jsp&quot;).forward(request, response);&#10;&#9;&#9;}&#10;&#9;&#9;else if (&quot;register&quot;.equals(kase)) {&#10;&#9;&#9;&#9;System.out.println(&quot;Inside Register Case - Processing Signup&quot;);&#10;&#9;&#9;&#9;&#10;&#9;&#9;&#9;// Get form parameters&#10;&#9;&#9;&#9;String username = request.getParameter(&quot;username&quot;);&#10;&#9;&#9;&#9;String password = request.getParameter(&quot;password&quot;);&#10;&#9;&#9;&#9;String email = request.getParameter(&quot;email&quot;);&#10;&#9;&#9;&#9;String fname = request.getParameter(&quot;fname&quot;);&#10;&#9;&#9;&#9;&#10;&#9;&#9;&#9;// Validation&#10;&#9;&#9;&#9;StringBuilder errorMessages = new StringBuilder();&#10;&#9;&#9;&#9;&#10;&#9;&#9;&#9;// Validate username&#10;&#9;&#9;&#9;if (username == null || username.trim().isEmpty()) {&#10;&#9;&#9;&#9;&#9;errorMessages.append(&quot;Username is required. &quot;);&#10;&#9;&#9;&#9;} else if (username.length() &lt; 3 || username.length() &gt; 50) {&#10;&#9;&#9;&#9;&#9;errorMessages.append(&quot;Username must be between 3 and 50 characters. &quot;);&#10;&#9;&#9;&#9;} else if (!username.matches(&quot;^[a-zA-Z0-9_]+$&quot;)) {&#10;&#9;&#9;&#9;&#9;errorMessages.append(&quot;Username can only contain letters, numbers, and underscores. &quot;);&#10;&#9;&#9;&#9;}&#10;&#9;&#9;&#9;&#10;&#9;&#9;&#9;// Validate password&#10;&#9;&#9;&#9;if (password == null || password.trim().isEmpty()) {&#10;&#9;&#9;&#9;&#9;errorMessages.append(&quot;Password is required. &quot;);&#10;&#9;&#9;&#9;} else if (password.length() &lt; 6 || password.length() &gt; 100) {&#10;&#9;&#9;&#9;&#9;errorMessages.append(&quot;Password must be between 6 and 100 characters. &quot;);&#10;&#9;&#9;&#9;}&#10;&#9;&#9;&#9;&#10;&#9;&#9;&#9;// Validate email&#10;&#9;&#9;&#9;if (email == null || email.trim().isEmpty()) {&#10;&#9;&#9;&#9;&#9;errorMessages.append(&quot;Email is required. &quot;);&#10;&#9;&#9;&#9;} else if (!email.matches(&quot;^[A-Za-z0-9+_.-]+@[A-Za-z0-9.-]+\\.[A-Za-z]{2,}$&quot;)) {&#10;&#9;&#9;&#9;&#9;errorMessages.append(&quot;Invalid email format. &quot;);&#10;&#9;&#9;&#9;} else if (email.length() &gt; 100) {&#10;&#9;&#9;&#9;&#9;errorMessages.append(&quot;Email is too long. &quot;);&#10;&#9;&#9;&#9;}&#10;&#9;&#9;&#9;&#10;&#9;&#9;&#9;// Validate full name&#10;&#9;&#9;&#9;if (fname == null || fname.trim().isEmpty()) {&#10;&#9;&#9;&#9;&#9;errorMessages.append(&quot;Full name is required. &quot;);&#10;&#9;&#9;&#9;} else if (fname.length() &lt; 2 || fname.length() &gt; 100) {&#10;&#9;&#9;&#9;&#9;errorMessages.append(&quot;Full name must be between 2 and 100 characters. &quot;);&#10;&#9;&#9;&#9;} else if (!fname.matches(&quot;^[a-zA-Z\\s]+$&quot;)) {&#10;&#9;&#9;&#9;&#9;errorMessages.append(&quot;Full name can only contain letters and spaces. &quot;);&#10;&#9;&#9;&#9;}&#10;&#9;&#9;&#9;&#10;&#9;&#9;&#9;// If validation fails, redirect back with error message&#10;&#9;&#9;&#9;if (errorMessages.length() &gt; 0) {&#10;&#9;&#9;&#9;&#9;System.out.println(&quot;Validation errors: &quot; + errorMessages.toString());&#10;&#9;&#9;&#9;&#9;request.setAttribute(&quot;error&quot;, errorMessages.toString());&#10;&#9;&#9;&#9;&#9;request.setAttribute(&quot;username&quot;, username);&#10;&#9;&#9;&#9;&#9;request.setAttribute(&quot;email&quot;, email);&#10;&#9;&#9;&#9;&#9;request.setAttribute(&quot;fname&quot;, fname);&#10;&#9;&#9;&#9;&#9;request.getRequestDispatcher(&quot;/WEB-INF/jsps/user.signup.jsp&quot;).forward(request, response);&#10;&#9;&#9;&#9;&#9;return;&#10;&#9;&#9;&#9;}&#10;&#9;&#9;&#9;&#10;&#9;&#9;&#9;// Sanitize inputs (trim whitespace)&#10;&#9;&#9;&#9;username = username.trim();&#10;&#9;&#9;&#9;email = email.trim();&#10;&#9;&#9;&#9;fname = fname.trim();&#10;&#9;&#9;&#9;&#10;&#9;&#9;&#9;// Create new user model&#10;&#9;&#9;&#9;UserModel newUser = new UserModel();&#10;&#9;&#9;&#9;newUser.setUser(username);&#10;&#9;&#9;&#9;newUser.setPass(password);&#10;&#9;&#9;&#9;newUser.setEmail(email);&#10;&#9;&#9;&#9;newUser.setFname(fname);&#10;&#9;&#9;&#9;&#10;&#9;&#9;&#9;// Save to database&#10;&#9;&#9;&#9;UserDAO ud = new UserDAO();&#10;&#9;&#9;&#9;try {&#10;&#9;&#9;&#9;&#9;ud.addUser(newUser);&#10;&#9;&#9;&#9;&#9;System.out.println(&quot;User registered successfully: &quot; + username);&#10;&#9;&#9;&#9;&#9;&#10;&#9;&#9;&#9;&#9;// Set success message and redirect to login&#10;&#9;&#9;&#9;&#9;request.setAttribute(&quot;message&quot;, &quot;Registration successful! Please login.&quot;);&#10;&#9;&#9;&#9;&#9;request.getRequestDispatcher(&quot;/WEB-INF/jsps/user.login.jsp&quot;).forward(request, response);&#10;&#9;&#9;&#9;} catch (Exception e) {&#10;&#9;&#9;&#9;&#9;System.out.println(&quot;Error registering user: &quot; + e.getMessage());&#10;&#9;&#9;&#9;&#9;request.setAttribute(&quot;error&quot;, &quot;Registration failed. Username or email may already exist.&quot;);&#10;&#9;&#9;&#9;&#9;request.setAttribute(&quot;username&quot;, username);&#10;&#9;&#9;&#9;&#9;request.setAttribute(&quot;email&quot;, email);&#10;&#9;&#9;&#9;&#9;request.setAttribute(&quot;fname&quot;, fname);&#10;&#9;&#9;&#9;&#9;request.getRequestDispatcher(&quot;/WEB-INF/jsps/user.signup.jsp&quot;).forward(request, response);&#10;&#9;&#9;&#9;}&#10;&#9;&#9;}&#10;&#9;&#9;else if(&quot;setting&quot;.equals(kase)) {&#10;&#9;&#9;&#9;view=&quot;/WEB-INF/jsps/user.setting.jsp&quot;;&#10;&#9;&#9;&#9;HttpSession session = request.getSession(false);&#10;&#9;&#9;&#9;if(session != null &amp;&amp; session.getAttribute(&quot;UserName&quot;) != null){&#10;&#9;&#9;&#9;&#9;request.getRequestDispatcher(&quot;/WEB-INF/jsps/user.setting.jsp&quot;).forward(request, response);&#10;&#9;&#9;&#9;}&#10;&#9;&#9;&#9;else {&#10;&#9;&#9;&#9;&#9;request.getRequestDispatcher(&quot;/WEB-INF/jsps/user.login.jsp&quot;).forward(request, response);&#10;&#9;&#9;&#9;}&#10;&#9;&#9;}&#10;&#9;&#9;else if(&quot;welcome&quot;.equals(kase)) {&#10;&#9;&#9;&#9;HttpSession session = request.getSession(false);&#10;&#9;&#9;&#9;if(session != null &amp;&amp; session.getAttribute(&quot;UserName&quot;) != null){&#10;&#9;&#9;&#9;&#9;request.getRequestDispatcher(&quot;/WEB-INF/jsps/user.welcome.jsp&quot;).forward(request, response);&#10;&#9;&#9;&#9;}&#10;&#9;&#9;&#9;else {&#10;&#9;&#9;&#9;&#9;request.getRequestDispatcher(&quot;/WEB-INF/jsps/user.login.jsp&quot;).forward(request, response);&#10;&#9;&#9;&#9;}&#10;&#9;&#9;}&#10;&#10;&#9;&#9;else if (&quot;logout&quot;.equals(kase)) {&#10;&#9;&#9;&#9;&#9;view = &quot;/WEB-INF/jsps/user.login.jsp&quot;;&#10;&#9;&#9;&#9;&#9;HttpSession session = request.getSession(false);&#10;&#9;&#9;&#9;&#9;if (session != null) {&#10;&#9;&#9;&#9;&#9;&#9;session.invalidate();&#10;&#9;&#9;&#9;&#9;}&#10;&#9;&#9;&#9;&#9;response.sendRedirect(&quot;login&quot;);&#10;&#10;&#9;&#9;&#9;} else {&#10;&#9;&#9;&#9;&#9;System.out.println(&quot;not of the Usercontroller cases are fired&quot;);&#10;&#9;&#9;&#9;&#9;System.out.println(&quot;not of the Usercontroller cases are fired&quot;);&#10;&#9;&#9;&#9;}&#10;&#9;&#9;&#9;System.out.println(&quot;User Controller End&quot;);&#10;&#10;&#9;&#9;}&#10;&#10;}&#10;" />
              <option name="updatedContent" value="package pk.edu.zab.controller;&#10;&#10;import java.io.IOException;&#10;import java.util.List;&#10;&#10;import javax.servlet.RequestDispatcher;&#10;import javax.servlet.ServletException;&#10;import javax.servlet.http.HttpServlet;&#10;import javax.servlet.http.HttpServletRequest;&#10;import javax.servlet.http.HttpServletResponse;&#10;import javax.servlet.http.HttpSession;&#10;&#10;import pk.edu.zab.dao.UserDAO;&#10;import pk.edu.zab.model.UserModel;&#10;&#10;@SuppressWarnings(&quot;serial&quot;)&#10;public class UserController extends HttpServlet {&#10;&#9;private RequestDispatcher dispatch;&#10;&#9;private String view, kase;&#10;&#9;private String username;&#10;&#9;private String password;&#10;&#9;UserModel um = new UserModel();&#10;&#9;private int userId;&#10;&#9;private String UserName;&#10;&#9;private String getRoles;&#10;&#9;HttpSession session = null;&#10;&#9;private int role_id;&#10;&#10;&#10;    protected void service(HttpServletRequest request, HttpServletResponse response)&#10;&#9;&#9;&#9;throws ServletException, IOException {&#10;&#10;&#10;&#9;&#9;kase = (String) request.getAttribute(&quot;kase&quot;);&#10;&#10;&#9;&#9;if (&quot;auth&quot;.equals(kase)) {&#10;&#10;&#9;&#9;&#9;HttpSession session = request.getSession(false);&#10;&#9;&#9;&#9;if (session != null &amp;&amp; session.getAttribute(&quot;UserName&quot;) != null) {&#10;&#9;&#9;&#9;&#9;request.getRequestDispatcher(&quot;/user/welcome&quot;).forward(request, response);&#10;&#9;&#9;&#9;} else {&#10;&#9;&#9;&#9;&#9;username = request.getParameter(&quot;username&quot;);&#10;&#9;&#9;&#9;&#9;password = request.getParameter(&quot;password&quot;);&#10;&#9;&#9;&#9;&#9;System.out.println(&quot;ID pass: &quot; + username);&#10;&#9;&#9;&#9;&#9;// need to check user &amp; pass&#10;&#9;&#9;&#9;&#9;UserDAO ud = new UserDAO();&#10;&#9;&#9;&#9;&#9;UserModel um = ud.checkUser(username, password);&#10;&#10;&#9;&#9;&#9;&#9;if (um.getUser() != null) {&#10;&#9;&#9;&#9;&#9;&#9;System.out.println(&quot;Valid user&quot;);&#10;&#9;&#9;&#9;&#9;&#9;userId = (int) um.getIduser();&#10;&#9;&#9;&#9;&#9;&#9;UserName = (String) um.getUser();&#10;&#9;&#9;&#9;&#9;&#9;System.out.println(&quot;userId: &quot; + userId);&#10;&#10;&#9;&#9;&#9;&#9;&#9;session = request.getSession();&#10;&#9;&#9;&#9;&#9;&#9;session.setAttribute(&quot;UserName&quot;, UserName);&#10;&#10;&#9;&#9;&#9;&#9;&#9;request.setAttribute(&quot;session&quot;, session);&#10;&#9;&#9;&#9;&#9;&#9;request.getRequestDispatcher(&quot;WEB-INF/jsps/user.welcome.jsp&quot;).forward(request, response);&#10;&#9;&#9;&#9;&#9;} else {&#10;&#9;&#9;&#9;&#9;&#9;System.out.println(&quot;Not valid user&quot;);&#10;&#9;&#9;&#9;&#9;}&#10;&#9;&#9;&#9;}&#10;&#9;&#9;}&#10;&#9;&#9;// edit this portion&#10;&#9;&#9;else if (&quot;login&quot;.equals(kase)) {&#10;&#9;&#9;&#9;System.out.println(&quot;Inside Login Case&quot;);&#10;&#9;&#9;&#9;HttpSession session = request.getSession(false);&#10;&#9;&#9;&#9;if (session != null &amp;&amp; session.getAttribute(&quot;UserName&quot;) != null) {&#10;&#9;&#9;&#9;&#9;request.getRequestDispatcher(&quot;/WEB-INF/jsps/user.welcome.jsp&quot;).forward(request, response);&#10;&#9;&#9;&#9;}&#10;&#10;&#9;&#9;&#9;else {&#10;&#9;&#9;&#9;&#9;request.getRequestDispatcher(&quot;/WEB-INF/jsps/user.login.jsp&quot;).forward(request, response);&#10;&#9;&#9;&#9;}&#10;&#10;&#9;&#9;}&#10;&#9;&#9;else if (&quot;signup&quot;.equals(kase)) {&#10;&#9;&#9;&#9;System.out.println(&quot;Inside Signup Case&quot;);&#10;&#9;&#9;&#9;request.getRequestDispatcher(&quot;/WEB-INF/jsps/user.signup.jsp&quot;).forward(request, response);&#10;&#9;&#9;}&#10;&#9;&#9;else if (&quot;register&quot;.equals(kase)) {&#10;&#9;&#9;&#9;System.out.println(&quot;Inside Register Case - Processing Signup&quot;);&#10;&#9;&#9;&#9;&#10;&#9;&#9;&#9;// Get form parameters&#10;&#9;&#9;&#9;String username = request.getParameter(&quot;username&quot;);&#10;&#9;&#9;&#9;String password = request.getParameter(&quot;password&quot;);&#10;&#9;&#9;&#9;String email = request.getParameter(&quot;email&quot;);&#10;&#9;&#9;&#9;String fname = request.getParameter(&quot;fname&quot;);&#10;&#9;&#9;&#9;&#10;&#9;&#9;&#9;// Validation&#10;&#9;&#9;&#9;StringBuilder errorMessages = new StringBuilder();&#10;&#9;&#9;&#9;&#10;&#9;&#9;&#9;// Validate username&#10;&#9;&#9;&#9;if (username == null || username.trim().isEmpty()) {&#10;&#9;&#9;&#9;&#9;errorMessages.append(&quot;Username is required. &quot;);&#10;&#9;&#9;&#9;} else if (username.length() &lt; 3 || username.length() &gt; 50) {&#10;&#9;&#9;&#9;&#9;errorMessages.append(&quot;Username must be between 3 and 50 characters. &quot;);&#10;&#9;&#9;&#9;} else if (!username.matches(&quot;^[a-zA-Z0-9_]+$&quot;)) {&#10;&#9;&#9;&#9;&#9;errorMessages.append(&quot;Username can only contain letters, numbers, and underscores. &quot;);&#10;&#9;&#9;&#9;}&#10;&#9;&#9;&#9;&#10;&#9;&#9;&#9;// Validate password&#10;&#9;&#9;&#9;if (password == null || password.trim().isEmpty()) {&#10;&#9;&#9;&#9;&#9;errorMessages.append(&quot;Password is required. &quot;);&#10;&#9;&#9;&#9;} else if (password.length() &lt; 6 || password.length() &gt; 100) {&#10;&#9;&#9;&#9;&#9;errorMessages.append(&quot;Password must be between 6 and 100 characters. &quot;);&#10;&#9;&#9;&#9;}&#10;&#9;&#9;&#9;&#10;&#9;&#9;&#9;// Validate email&#10;&#9;&#9;&#9;if (email == null || email.trim().isEmpty()) {&#10;&#9;&#9;&#9;&#9;errorMessages.append(&quot;Email is required. &quot;);&#10;&#9;&#9;&#9;} else if (!email.matches(&quot;^[A-Za-z0-9+_.-]+@[A-Za-z0-9.-]+\\.[A-Za-z]{2,}$&quot;)) {&#10;&#9;&#9;&#9;&#9;errorMessages.append(&quot;Invalid email format. &quot;);&#10;&#9;&#9;&#9;} else if (email.length() &gt; 100) {&#10;&#9;&#9;&#9;&#9;errorMessages.append(&quot;Email is too long. &quot;);&#10;&#9;&#9;&#9;}&#10;&#9;&#9;&#9;&#10;&#9;&#9;&#9;// Validate full name&#10;&#9;&#9;&#9;if (fname == null || fname.trim().isEmpty()) {&#10;&#9;&#9;&#9;&#9;errorMessages.append(&quot;Full name is required. &quot;);&#10;&#9;&#9;&#9;} else if (fname.length() &lt; 2 || fname.length() &gt; 100) {&#10;&#9;&#9;&#9;&#9;errorMessages.append(&quot;Full name must be between 2 and 100 characters. &quot;);&#10;&#9;&#9;&#9;} else if (!fname.matches(&quot;^[a-zA-Z\\s]+$&quot;)) {&#10;&#9;&#9;&#9;&#9;errorMessages.append(&quot;Full name can only contain letters and spaces. &quot;);&#10;&#9;&#9;&#9;}&#10;&#9;&#9;&#9;&#10;&#9;&#9;&#9;// If validation fails, redirect back with error message&#10;&#9;&#9;&#9;if (errorMessages.length() &gt; 0) {&#10;&#9;&#9;&#9;&#9;System.out.println(&quot;Validation errors: &quot; + errorMessages.toString());&#10;&#9;&#9;&#9;&#9;request.setAttribute(&quot;error&quot;, errorMessages.toString());&#10;&#9;&#9;&#9;&#9;request.setAttribute(&quot;username&quot;, username);&#10;&#9;&#9;&#9;&#9;request.setAttribute(&quot;email&quot;, email);&#10;&#9;&#9;&#9;&#9;request.setAttribute(&quot;fname&quot;, fname);&#10;&#9;&#9;&#9;&#9;request.getRequestDispatcher(&quot;/WEB-INF/jsps/user.signup.jsp&quot;).forward(request, response);&#10;&#9;&#9;&#9;&#9;return;&#10;&#9;&#9;&#9;}&#10;&#9;&#9;&#9;&#10;&#9;&#9;&#9;// Sanitize inputs (trim whitespace)&#10;&#9;&#9;&#9;username = username.trim();&#10;&#9;&#9;&#9;email = email.trim();&#10;&#9;&#9;&#9;fname = fname.trim();&#10;&#9;&#9;&#9;&#10;&#9;&#9;&#9;// Create new user model&#10;&#9;&#9;&#9;UserModel newUser = new UserModel();&#10;&#9;&#9;&#9;newUser.setUser(username);&#10;&#9;&#9;&#9;newUser.setPass(password);&#10;&#9;&#9;&#9;newUser.setEmail(email);&#10;&#9;&#9;&#9;newUser.setFname(fname);&#10;&#9;&#9;&#9;&#10;&#9;&#9;&#9;// Save to database&#10;&#9;&#9;&#9;UserDAO ud = new UserDAO();&#10;&#9;&#9;&#9;try {&#10;&#9;&#9;&#9;&#9;// Check duplicates first&#10;&#9;&#9;&#9;&#9;String exists = ud.existsUsernameOrEmail(username, email);&#10;&#9;&#9;&#9;&#9;if (&quot;username&quot;.equals(exists)) {&#10;&#9;&#9;&#9;&#9;&#9;request.setAttribute(&quot;error&quot;, &quot;Registration failed. Username already exists.&quot;);&#10;&#9;&#9;&#9;&#9;&#9;request.setAttribute(&quot;username&quot;, username);&#10;&#9;&#9;&#9;&#9;&#9;request.setAttribute(&quot;email&quot;, email);&#10;&#9;&#9;&#9;&#9;&#9;request.setAttribute(&quot;fname&quot;, fname);&#10;&#9;&#9;&#9;&#9;&#9;request.getRequestDispatcher(&quot;/WEB-INF/jsps/user.signup.jsp&quot;).forward(request, response);&#10;&#9;&#9;&#9;&#9;&#9;return;&#10;&#9;&#9;&#9;&#9;} else if (&quot;email&quot;.equals(exists)) {&#10;&#9;&#9;&#9;&#9;&#9;request.setAttribute(&quot;error&quot;, &quot;Registration failed. Email already registered.&quot;);&#10;&#9;&#9;&#9;&#9;&#9;request.setAttribute(&quot;username&quot;, username);&#10;&#9;&#9;&#9;&#9;&#9;request.setAttribute(&quot;email&quot;, email);&#10;&#9;&#9;&#9;&#9;&#9;request.setAttribute(&quot;fname&quot;, fname);&#10;&#9;&#9;&#9;&#9;&#9;request.getRequestDispatcher(&quot;/WEB-INF/jsps/user.signup.jsp&quot;).forward(request, response);&#10;&#9;&#9;&#9;&#9;&#9;return;&#10;&#9;&#9;&#9;&#9;} else if (&quot;exists&quot;.equals(exists)) {&#10;&#9;&#9;&#9;&#9;&#9;request.setAttribute(&quot;error&quot;, &quot;Registration failed. User or email already exists.&quot;);&#10;&#9;&#9;&#9;&#9;&#9;request.setAttribute(&quot;username&quot;, username);&#10;&#9;&#9;&#9;&#9;&#9;request.setAttribute(&quot;email&quot;, email);&#10;&#9;&#9;&#9;&#9;&#9;request.setAttribute(&quot;fname&quot;, fname);&#10;&#9;&#9;&#9;&#9;&#9;request.getRequestDispatcher(&quot;/WEB-INF/jsps/user.signup.jsp&quot;).forward(request, response);&#10;&#9;&#9;&#9;&#9;&#9;return;&#10;&#9;&#9;&#9;&#9;}&#10;&#9;&#9;&#9;&#9;// proceed to insert&#10;&#9;&#9;&#9;&#9;ud.addUser(newUser);&#10;&#9;&#9;&#9;&#9;System.out.println(&quot;User registered successfully: &quot; + username);&#10;&#9;&#9;&#9;&#9;&#10;&#9;&#9;&#9;&#9;// Set success message and redirect to login&#10;&#9;&#9;&#9;&#9;request.setAttribute(&quot;message&quot;, &quot;Registration successful! Please login.&quot;);&#10;&#9;&#9;&#9;&#9;request.getRequestDispatcher(&quot;/WEB-INF/jsps/user.login.jsp&quot;).forward(request, response);&#10;&#9;&#9;&#9;} catch (Exception e) {&#10;&#9;&#9;&#9;&#9;System.out.println(&quot;Error registering user: &quot; + e.getMessage());&#10;&#9;&#9;&#9;&#9;request.setAttribute(&quot;error&quot;, &quot;Registration failed. Please try again later.&quot;);&#10;&#9;&#9;&#9;&#9;request.setAttribute(&quot;username&quot;, username);&#10;&#9;&#9;&#9;&#9;request.setAttribute(&quot;email&quot;, email);&#10;&#9;&#9;&#9;&#9;request.setAttribute(&quot;fname&quot;, fname);&#10;&#9;&#9;&#9;&#9;request.getRequestDispatcher(&quot;/WEB-INF/jsps/user.signup.jsp&quot;).forward(request, response);&#10;&#9;&#9;&#9;}&#10;&#9;&#9;}&#10;&#9;&#9;else if(&quot;setting&quot;.equals(kase)) {&#10;&#9;&#9;&#9;view=&quot;/WEB-INF/jsps/user.setting.jsp&quot;;&#10;&#9;&#9;&#9;HttpSession session = request.getSession(false);&#10;&#9;&#9;&#9;if(session != null &amp;&amp; session.getAttribute(&quot;UserName&quot;) != null){&#10;&#9;&#9;&#9;&#9;request.getRequestDispatcher(&quot;/WEB-INF/jsps/user.setting.jsp&quot;).forward(request, response);&#10;&#9;&#9;&#9;}&#10;&#9;&#9;&#9;else {&#10;&#9;&#9;&#9;&#9;request.getRequestDispatcher(&quot;/WEB-INF/jsps/user.login.jsp&quot;).forward(request, response);&#10;&#9;&#9;&#9;}&#10;&#9;&#9;}&#10;&#9;&#9;else if(&quot;welcome&quot;.equals(kase)) {&#10;&#9;&#9;&#9;HttpSession session = request.getSession(false);&#10;&#9;&#9;&#9;if(session != null &amp;&amp; session.getAttribute(&quot;UserName&quot;) != null){&#10;&#9;&#9;&#9;&#9;request.getRequestDispatcher(&quot;/WEB-INF/jsps/user.welcome.jsp&quot;).forward(request, response);&#10;&#9;&#9;&#9;}&#10;&#9;&#9;&#9;else {&#10;&#9;&#9;&#9;&#9;request.getRequestDispatcher(&quot;/WEB-INF/jsps/user.login.jsp&quot;).forward(request, response);&#10;&#9;&#9;&#9;}&#10;&#9;&#9;}&#10;&#10;&#9;&#9;else if (&quot;logout&quot;.equals(kase)) {&#10;&#9;&#9;&#9;&#9;view = &quot;/WEB-INF/jsps/user.login.jsp&quot;;&#10;&#9;&#9;&#9;&#9;HttpSession session = request.getSession(false);&#10;&#9;&#9;&#9;&#9;if (session != null) {&#10;&#9;&#9;&#9;&#9;&#9;session.invalidate();&#10;&#9;&#9;&#9;&#9;}&#10;&#9;&#9;&#9;&#9;response.sendRedirect(&quot;login&quot;);&#10;&#10;&#9;&#9;&#9;} else {&#10;&#9;&#9;&#9;&#9;System.out.println(&quot;not of the Usercontroller cases are fired&quot;);&#10;&#9;&#9;&#9;&#9;System.out.println(&quot;not of the Usercontroller cases are fired&quot;);&#10;&#9;&#9;&#9;}&#10;&#9;&#9;&#9;System.out.println(&quot;User Controller End&quot;);&#10;&#10;&#9;&#9;}&#10;&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>